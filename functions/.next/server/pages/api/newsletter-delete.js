"use strict";(()=>{var e={};e.id=399,e.ids=[399],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},3478:(e,t,s)=>{s.r(t),s.d(t,{config:()=>p,default:()=>d,routeModule:()=>m});var r={};s.r(r),s.d(r,{default:()=>f});var n=s(1802),o=s(7153),i=s(6249),a=s(3292),l=s.n(a),u=s(1017),c=s.n(u);async function f(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method not allowed"});try{let{filename:s}=e.body;if(!s)return t.status(400).json({success:!1,message:"파일명이 필요합니다."});let r=c().resolve(process.cwd(),"public/newsletters"),n=c().join(r,"newsletters.json"),o=c().join(r,`${s}.html`),i=!1;try{await l().access(o),i=!0}catch{i=!1}let a=c().join(process.cwd(),"functions","public","newsletters","newsletters.json"),u=[],f=!1;try{let e=await l().readFile(n,"utf-8");u=JSON.parse(e),Array.isArray(u)||(u=[]),f=u.some(e=>e.filename===s)}catch{u=[],f=!1}if(!i&&!f)return t.status(404).json({success:!1,message:`'${s}' 뉴스레터를 찾을 수 없습니다. (HTML 파일 및 목록에서 존재하지 않음)`});let d=[],p=[];try{if(i&&(await l().unlink(o),console.log(`HTML 파일 삭제됨: ${o}`),d.push("HTML 파일")),f){let e=u.filter(e=>e.filename!==s);await l().writeFile(n,JSON.stringify(e,null,2),"utf-8"),console.log(`newsletters.json에서 항목 제거 및 저장 완료`),d.push("목록 항목");try{await l().writeFile(a,JSON.stringify(e,null,2),"utf-8"),console.log("[newsletters] Firebase Functions 파일도 업데이트됨")}catch(e){console.warn("[newsletters] Firebase Functions 파일 업데이트 실패:",e),p.push("Functions 파일 동기화 실패")}}let e=`'${s}' 뉴스레터 삭제 완료 (${d.join(", ")})`+(p.length>0?` - 경고: ${p.join(", ")}`:"");return t.status(200).json({success:!0,message:e,details:{htmlDeleted:i,jsonDeleted:f,errors:p}})}catch(e){return console.error("파일 삭제 중 오류:",e),t.status(500).json({success:!1,message:"파일 삭제 중 오류가 발생했습니다.",error:e instanceof Error?e.message:"알 수 없는 오류"})}}catch(e){return console.error("뉴스레터 삭제 중 오류:",e),t.status(500).json({success:!1,message:"뉴스레터 삭제에 실패했습니다.",error:e instanceof Error?e.message:"알 수 없는 오류"})}}let d=(0,i.l)(r,"default"),p=(0,i.l)(r,"config"),m=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/newsletter-delete",pathname:"/api/newsletter-delete",bundlePath:"",filename:""},userland:r})},7153:(e,t)=>{var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{e.exports=s(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var s=t(t.s=3478);module.exports=s})();