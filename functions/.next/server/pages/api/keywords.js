"use strict";(()=>{var e={};e.id=254,e.ids=[254],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},6249:(e,s)=>{Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,t){return t in s?s[t]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,t)):"function"==typeof s&&"default"===t?s:void 0}}})},8124:(e,s,t)=>{t.r(s),t.d(s,{config:()=>p,default:()=>y,routeModule:()=>P});var r={};t.r(r),t.d(r,{default:()=>w});var o=t(1802),n=t(7153),i=t(6249),u=t(3292),a=t.n(u),c=t(1017),l=t.n(c);let d=l().join(process.cwd(),"public","keywords.json"),f=l().join(process.cwd(),"functions","public","keywords.json");async function w(e,s){if(s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),s.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),"OPTIONS"===e.method){s.status(200).end();return}if("GET"===e.method)try{let e=await a().readFile(d,"utf-8"),t=JSON.parse(e);s.status(200).json({success:!0,keywords:t})}catch(e){console.error("키워드 파일 읽기 오류:",e),s.status(500).json({success:!1,error:"키워드 파일을 읽을 수 없습니다."})}else if("POST"===e.method)try{let{keyword:t}=e.body;if(!t||"string"!=typeof t||""===t.trim())return s.status(400).json({success:!1,error:"유효한 키워드를 입력해주세요."});let r=t.trim(),o=await a().readFile(d,"utf-8"),n=JSON.parse(o);if(n.includes(r))return s.status(400).json({success:!1,error:"이미 존재하는 키워드입니다."});n.push(r),await a().writeFile(d,JSON.stringify(n,null,2),"utf-8");try{await a().writeFile(f,JSON.stringify(n,null,2),"utf-8"),console.log("[keywords] Firebase Functions 파일도 업데이트됨")}catch(e){console.warn("[keywords] Firebase Functions 파일 업데이트 실패:",e)}s.status(200).json({success:!0,message:"키워드가 추가되었습니다.",keywords:n})}catch(e){console.error("키워드 추가 오류:",e),s.status(500).json({success:!1,error:"키워드 추가 중 오류가 발생했습니다."})}else if("PUT"===e.method)try{let{oldKeyword:t,newKeyword:r}=e.body;if(!t||!r||"string"!=typeof t||"string"!=typeof r)return s.status(400).json({success:!1,error:"유효한 키워드를 입력해주세요."});let o=r.trim();if(""===o)return s.status(400).json({success:!1,error:"새 키워드는 비어있을 수 없습니다."});let n=await a().readFile(d,"utf-8"),i=JSON.parse(n),u=i.indexOf(t);if(-1===u)return s.status(404).json({success:!1,error:"수정할 키워드를 찾을 수 없습니다."});if(i.includes(o)&&t!==o)return s.status(400).json({success:!1,error:"이미 존재하는 키워드입니다."});i[u]=o,await a().writeFile(d,JSON.stringify(i,null,2),"utf-8");try{await a().writeFile(f,JSON.stringify(i,null,2),"utf-8"),console.log("[keywords] Firebase Functions 파일도 업데이트됨")}catch(e){console.warn("[keywords] Firebase Functions 파일 업데이트 실패:",e)}s.status(200).json({success:!0,message:"키워드가 수정되었습니다.",keywords:i})}catch(e){console.error("키워드 수정 오류:",e),s.status(500).json({success:!1,error:"키워드 수정 중 오류가 발생했습니다."})}else if("DELETE"===e.method)try{let{keyword:t}=e.body;if(!t||"string"!=typeof t)return s.status(400).json({success:!1,error:"유효한 키워드를 입력해주세요."});let r=await a().readFile(d,"utf-8"),o=JSON.parse(r),n=o.indexOf(t);if(-1===n)return s.status(404).json({success:!1,error:"삭제할 키워드를 찾을 수 없습니다."});o.splice(n,1),await a().writeFile(d,JSON.stringify(o,null,2),"utf-8");try{await a().writeFile(f,JSON.stringify(o,null,2),"utf-8"),console.log("[keywords] Firebase Functions 파일도 업데이트됨")}catch(e){console.warn("[keywords] Firebase Functions 파일 업데이트 실패:",e)}s.status(200).json({success:!0,message:"키워드가 삭제되었습니다.",keywords:o})}catch(e){console.error("키워드 삭제 오류:",e),s.status(500).json({success:!1,error:"키워드 삭제 중 오류가 발생했습니다."})}else s.setHeader("Allow",["GET","POST","PUT","DELETE"]),s.status(405).end(`Method ${e.method} Not Allowed`)}let y=(0,i.l)(r,"default"),p=(0,i.l)(r,"config"),P=new o.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/keywords",pathname:"/api/keywords",bundlePath:"",filename:""},userland:r})},7153:(e,s)=>{var t;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,s,t)=>{e.exports=t(145)}};var s=require("../../webpack-api-runtime.js");s.C(e);var t=s(s.s=8124);module.exports=t})();