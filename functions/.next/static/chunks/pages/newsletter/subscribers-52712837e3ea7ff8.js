(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[831],{1508:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/newsletter/subscribers",function(){return s(7044)}])},7044:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(5893),n=s(7294),l=s(9008),c=s.n(l),i=s(1664),r=s.n(i),d=s(4611);function h(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)([]),[i,h]=(0,n.useState)(!0),[o,u]=(0,n.useState)(""),[j,x]=(0,n.useState)("all");(0,n.useEffect)(()=>{m()},[]),(0,n.useEffect)(()=>{p()},[e,o,j]);let m=async()=>{try{let e=await fetch("/api/newsletter-recipients");if(e.ok){let s=await e.json();t(s.recipients||[])}else console.error("신청자 목록을 불러오는데 실패했습니다.")}catch(e){console.error("신청자 목록 로드 오류:",e)}finally{h(!1)}},p=()=>{let t=e;if("all"!==j&&(t=t.filter(e=>e.status===j)),o){let e=o.toLowerCase();t=t.filter(t=>t.name.toLowerCase().includes(e)||t.email.toLowerCase().includes(e)||t.company&&t.company.toLowerCase().includes(e))}l(t)},b=async(e,t)=>{let s="active"===t?"inactive":"active";if(confirm("이 구독자를 ".concat("active"===s?"활성화":"비활성화","하시겠습니까?")))try{let t=await fetch("/api/newsletter-subscriber-update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:s})}),a=await t.json();if(t.ok)alert(a.message),await m();else throw Error(a.message||"상태 변경 중 오류가 발생했습니다.")}catch(t){let e=t instanceof Error?t.message:String(t);alert("오류: ".concat(e))}},f=async(e,t)=>{if(confirm("'".concat(t,"' 구독자를 정말 삭제하시겠습니까?\n이 작업은 되돌릴 수 없습니다.")))try{let t=await fetch("/api/newsletter-subscriber-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),s=await t.json();if(t.ok)alert(s.message),await m();else throw Error(s.message||"삭제 중 오류가 발생했습니다.")}catch(t){let e=t instanceof Error?t.message:String(t);alert("오류: ".concat(e))}};return i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{children:(0,a.jsx)("title",{children:"뉴스레터 신청자 관리 - ".concat(d.j)})}),(0,a.jsx)("div",{className:"container",children:(0,a.jsx)("div",{className:"loading",children:"신청자 목록을 불러오는 중..."})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("title",{children:"뉴스레터 신청자 관리 - ".concat(d.j)}),(0,a.jsx)("meta",{name:"description",content:"뉴스레터 신청자 관리"})]}),(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)("h1",{children:"뉴스레터 신청자 관리"}),(0,a.jsx)("div",{children:(0,a.jsx)(r(),{href:"/newsletter",children:(0,a.jsx)("button",{type:"button",className:"btn-back",children:"뉴스레터 목록"})})})]}),(0,a.jsxs)("div",{className:"subscribers-stats",children:[(0,a.jsxs)("div",{className:"stat-item",children:[(0,a.jsx)("span",{className:"stat-label",children:"전체 신청자:"}),(0,a.jsxs)("span",{className:"stat-value",children:[e.length,"명"]})]}),(0,a.jsxs)("div",{className:"stat-item",children:[(0,a.jsx)("span",{className:"stat-label",children:"활성 구독자:"}),(0,a.jsxs)("span",{className:"stat-value",children:[e.filter(e=>"active"===e.status).length,"명"]})]}),(0,a.jsxs)("div",{className:"stat-item",children:[(0,a.jsx)("span",{className:"stat-label",children:"비활성 구독자:"}),(0,a.jsxs)("span",{className:"stat-value",children:[e.filter(e=>"inactive"===e.status).length,"명"]})]}),(0,a.jsxs)("div",{className:"stat-item",children:[(0,a.jsx)("span",{className:"stat-label",children:"검색 결과:"}),(0,a.jsxs)("span",{className:"stat-value",children:[s.length,"명"]})]})]}),(0,a.jsxs)("div",{className:"subscribers-controls",children:[(0,a.jsx)("div",{className:"search-group",children:(0,a.jsx)("input",{type:"text",placeholder:"이름, 이메일, 회사명으로 검색...",value:o,onChange:e=>u(e.target.value),className:"search-input"})}),(0,a.jsx)("div",{className:"filter-group",children:(0,a.jsxs)("select",{value:j,onChange:e=>x(e.target.value),className:"status-filter",children:[(0,a.jsx)("option",{value:"all",children:"전체 상태"}),(0,a.jsx)("option",{value:"active",children:"활성 구독자"}),(0,a.jsx)("option",{value:"inactive",children:"비활성 구독자"})]})}),(o||"all"!==j)&&(0,a.jsx)("button",{type:"button",className:"btn-clear-filters",onClick:()=>{u(""),x("all")},children:"필터 초기화"})]}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"이름"}),(0,a.jsx)("th",{children:"이메일"}),(0,a.jsx)("th",{children:"회사/소속"}),(0,a.jsx)("th",{children:"연락처"}),(0,a.jsx)("th",{children:"신청일"}),(0,a.jsx)("th",{children:"상태"}),(0,a.jsx)("th",{style:{textAlign:"center"},children:"액션"})]})}),(0,a.jsx)("tbody",{children:s.length>0?s.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.name}),(0,a.jsx)("td",{children:e.email}),(0,a.jsx)("td",{children:e.company||"-"}),(0,a.jsx)("td",{children:e.phone||"-"}),(0,a.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString("ko-KR")}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"status-badge ".concat(e.status),children:"active"===e.status?"활성":"비활성"})}),(0,a.jsxs)("td",{className:"actions",children:[(0,a.jsx)("button",{type:"button",className:"btn-status ".concat("active"===e.status?"btn-deactivate":"btn-activate"),onClick:()=>b(e.id,e.status),children:"active"===e.status?"비활성화":"활성화"}),(0,a.jsx)("button",{type:"button",className:"btn-delete-subscriber",onClick:()=>f(e.id,e.name),title:"".concat(e.name," 삭제"),children:"삭제"})]})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,style:{textAlign:"center"},children:o||"all"!==j?"검색 결과가 없습니다.":"신청자가 없습니다."})})})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1508)}),_N_E=e.O()}]);